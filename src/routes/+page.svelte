<script lang="ts">
    // @ts-nocheck
	import { onMount } from "svelte";
    import LoginForm from "../components/LoginForm.svelte";
    import Header from "../components/text/Header.svelte";
	import { goto } from "$app/navigation";
	import type { Passenger } from "@prisma/client";
    
    let loading: boolean = true
    async function getAuthToken() {
        const authToken = await localStorage.getItem("authToken");
        if (authToken) {
            const response = await fetch('/api/decodeToken', {
            method: 'POST',
            body: JSON.stringify(authToken)
            });
            if (response.ok) {
                //token was decoded
                goto("/home")
            }
            else {
                //token was not decoded
            }
        }
        else {
            //authToken was not found in localStorage
        }
    }
    onMount(async () => {
        await getAuthToken();
        loading = false;
    }); 
</script>

<title>
    Monazite
</title>
{#if !loading}
    <div class="flex flex-col items-center w-screen h-screen pt-12 bg-neutral-950">
        <Header>Welcome to TaxiApp</Header>
            <div class="flex items-center justify-center w-56 h-56 mt-5 bg-yellow-app rounded-full">
                <svg class="mt-1" width="220.000000" height="220.000000" viewBox="0 0 220 220" fill="none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                    <desc>
                            Created with Pixso.
                    </desc>
                    <defs/>
                    <mask id="mask59_5869" mask-type="alpha" maskUnits="userSpaceOnUse" x="0.000000" y="0.000000" width="220.000000" height="220.000000">
                        <circle id="Ellipse 2" cx="110.000000" cy="110.000000" r="110.000000" fill="#E65C5C" fill-opacity="1.000000"/>
                    </mask>
                    <g mask="url(#mask59_5869)">
                        <path id="Vector" d="M128.82 200.68C140.61 205.07 150.47 213.42 156.79 224.1L62.74 224.1C69.06 213.41 78.92 205.07 90.71 200.68L128.82 200.68Z" fill="#61A2F9" fill-opacity="1.000000" fill-rule="nonzero"/>
                        <path id="Vector" d="M101.44 200.68C96.29 205.07 91.98 213.41 89.22 224.1L62.74 224.1C69.06 213.41 78.92 205.07 90.71 200.68L101.44 200.68Z" fill="#5490F9" fill-opacity="1.000000" fill-rule="nonzero"/>
                        <path id="Vector" d="M128.82 200.67L109.77 224.1L96.03 207.21L90.71 200.67C93.18 199.75 95.71 199.02 98.28 198.47L98.28 178.56L121.25 178.56L121.25 198.47C123.83 199.02 126.36 199.75 128.82 200.67Z" fill="#FFDDCE" fill-opacity="1.000000" fill-rule="nonzero"/>
                        <path id="Vector" d="M98.28 178.56L98.28 198.47C95.71 199.02 93.18 199.75 90.71 200.67L96.03 207.21C100.68 202.57 106.55 203.43 106.55 203.43L106.55 187.6L113.2 187.6C115.95 187.6 118.65 187.32 121.25 186.8L121.25 178.56L98.28 178.56Z" fill="#FFCBBE" fill-opacity="1.000000" fill-rule="nonzero"/>
                        <path id="Vector" d="M157.33 67.67L134.38 44.72C128.84 39.19 119.87 39.19 114.33 44.72C111.84 47.21 110.48 50.4 110.23 53.65L101.3 44.72C95.76 39.19 86.79 39.19 81.25 44.72C78.76 47.21 77.39 50.4 77.14 53.65L68.21 44.72C62.68 39.19 53.7 39.19 48.17 44.72C42.63 50.26 42.63 59.23 48.17 64.77C50.7 67.3 52.71 70.31 54.08 73.62C55.45 76.92 56.15 80.47 56.15 84.05L56.15 135.29L163.37 135.29L163.37 83.64C163.72 77.91 161.71 72.05 157.33 67.67Z" fill="#365E7D" fill-opacity="1.000000" fill-rule="nonzero"/>
                        <path id="Vector" d="M99.84 84.05L99.84 135.29L56.15 135.29L56.15 84.05C56.15 80.44 55.43 76.9 54.08 73.62C52.7 70.31 50.69 67.3 48.16 64.77C45.39 62 44.01 58.37 44.01 54.75C44.01 51.12 45.39 47.49 48.16 44.72C53.7 39.19 62.67 39.19 68.21 44.72L77.14 53.66C77.27 52.01 77.68 50.4 78.35 48.9C79.06 47.35 80.04 45.93 81.24 44.72C85.39 40.58 91.46 39.54 96.57 41.6C94.81 42.31 93.2 43.37 91.86 44.72C89.09 47.49 87.7 51.12 87.7 54.75C87.7 58.37 89.09 62 91.86 64.77C94.39 67.3 96.4 70.31 97.77 73.62C99.14 76.93 99.84 80.47 99.84 84.05Z" fill="#2B4D66" fill-opacity="1.000000" fill-rule="nonzero"/>
                        <path id="Vector" d="M73.42 137.95C73.42 146.07 66.84 152.65 58.72 152.65C50.6 152.65 44.01 146.07 44.01 137.95C44.01 129.82 50.6 123.24 58.72 123.24C66.84 123.24 73.42 129.82 73.42 137.95Z" fill="#FFCBBE" fill-opacity="1.000000" fill-rule="evenodd"/>
                        <path id="Vector" d="M175.51 137.95C175.51 146.07 168.93 152.65 160.81 152.65C152.69 152.65 146.11 146.07 146.11 137.95C146.11 129.83 152.69 123.24 160.81 123.24C168.93 123.24 175.51 129.83 175.51 137.95Z" fill="#FFCBBE" fill-opacity="1.000000" fill-rule="evenodd"/>
                        <path id="Vector" d="M126.72 80.12L92.82 80.12C78.05 80.12 66.09 92.09 66.09 106.85L66.09 139.12C66.09 161.35 84.11 179.38 106.34 179.38L113.2 179.38C135.43 179.38 153.45 161.35 153.45 139.12L153.45 106.85C153.45 92.09 141.48 80.12 126.72 80.12Z" fill="#FFDDCE" fill-opacity="1.000000" fill-rule="nonzero"/>
                        <path id="Vector" d="M121.45 178.53C118.74 179.09 115.97 179.37 113.2 179.37L106.34 179.37C84.11 179.37 66.09 161.35 66.09 139.12L66.09 106.85C66.09 92.08 78.06 80.12 92.82 80.12L116.19 80.12C101.42 80.12 89.46 92.08 89.46 106.85L89.46 139.12C89.46 158.52 103.18 174.72 121.45 178.53Z" fill="#FFCBBE" fill-opacity="1.000000" fill-rule="nonzero"/>
                        <path id="Vector" d="M166.14 121.31L166.14 83.72C166.33 80.41 165.82 77.09 164.64 73.98C163.46 70.88 161.64 68.06 159.29 65.71L157.05 63.47C156.53 62.96 155.83 62.67 155.1 62.67C154.36 62.67 153.66 62.96 153.14 63.48C152.63 64 152.33 64.7 152.33 65.43C152.33 66.17 152.62 66.87 153.14 67.39L155.37 69.62C157.17 71.43 158.57 73.6 159.48 75.98C160.38 78.37 160.76 80.92 160.61 83.47C160.6 83.53 160.6 83.58 160.6 83.64L160.6 120.48C159.12 120.5 157.64 120.7 156.21 121.09L156.21 106.85C156.21 90.58 142.98 77.35 126.72 77.35L92.81 77.35C81.75 77.35 71.71 83.46 66.62 93.28C66.28 93.93 66.22 94.69 66.44 95.39C66.66 96.09 67.15 96.67 67.8 97C68.46 97.34 69.21 97.41 69.91 97.19C70.61 96.97 71.19 96.48 71.53 95.83C75.67 87.85 83.82 82.89 92.81 82.89L126.72 82.89C139.92 82.89 150.67 93.64 150.67 106.85L150.67 139.13C150.67 159.79 133.86 176.61 113.19 176.61L106.33 176.61C85.67 176.61 68.85 159.79 68.85 139.13L68.85 106.85C68.85 106.37 68.87 105.86 68.9 105.35C68.92 104.99 68.88 104.62 68.76 104.28C68.64 103.93 68.46 103.61 68.21 103.34C67.97 103.07 67.68 102.84 67.35 102.68C67.02 102.52 66.67 102.43 66.3 102.4C65.94 102.38 65.57 102.43 65.23 102.55C64.88 102.67 64.57 102.86 64.29 103.1C64.02 103.34 63.8 103.64 63.64 103.97C63.48 104.3 63.39 104.65 63.37 105.02C63.33 105.63 63.31 106.24 63.31 106.85L63.31 121.09C61.88 120.7 60.41 120.5 58.92 120.48L58.92 84.05C58.93 80.1 58.15 76.2 56.64 72.55C55.13 68.91 52.92 65.6 50.13 62.81C47.97 60.65 46.78 57.79 46.78 54.74C46.78 51.7 47.97 48.83 50.13 46.68C54.57 42.23 61.81 42.23 66.26 46.68L75.19 55.61C75.56 55.99 76.04 56.24 76.56 56.36C77.07 56.47 77.61 56.43 78.11 56.25C78.61 56.06 79.04 55.74 79.36 55.32C79.68 54.89 79.87 54.39 79.91 53.86C80.01 52.54 80.33 51.24 80.88 50.04C81.45 48.79 82.24 47.65 83.21 46.68C87.66 42.23 94.89 42.23 99.34 46.68L108.27 55.61C108.64 55.98 109.12 56.24 109.63 56.36C110.15 56.47 110.69 56.43 111.19 56.25C111.68 56.07 112.12 55.74 112.44 55.32C112.76 54.9 112.95 54.39 112.99 53.86C113.09 52.54 113.42 51.25 113.96 50.04C114.53 48.79 115.32 47.65 116.3 46.68C120.74 42.23 127.98 42.23 132.42 46.68L145.31 59.56C145.83 60.08 146.53 60.37 147.27 60.37C148 60.37 148.7 60.08 149.22 59.56C149.74 59.04 150.03 58.34 150.03 57.6C150.03 56.87 149.74 56.16 149.22 55.64L136.34 42.76C129.73 36.16 118.98 36.16 112.38 42.76C110.81 44.33 109.57 46.18 108.72 48.22L103.26 42.76C96.65 36.16 85.9 36.16 79.29 42.76C77.72 44.33 76.48 46.18 75.63 48.22L70.17 42.76C63.56 36.16 52.81 36.16 46.21 42.76C43.01 45.96 41.25 50.22 41.25 54.74C41.25 59.27 43.01 63.52 46.21 66.72C48.49 69 50.29 71.7 51.52 74.68C52.75 77.65 53.39 80.83 53.38 84.05L53.38 121.31C46.35 123.57 41.25 130.17 41.25 137.95C41.25 147.58 49.08 155.42 58.72 155.42C61.24 155.42 63.68 154.89 65.92 153.87C70.73 167.03 81.8 177.2 95.51 180.77L95.51 196.27C80.84 200.03 68.12 209.56 60.35 222.69C60.1 223.11 59.97 223.59 59.97 224.08C59.96 224.57 60.09 225.05 60.33 225.47C60.57 225.9 60.92 226.25 61.34 226.5C61.77 226.74 62.25 226.87 62.73 226.87L156.79 226.87C157.28 226.87 157.76 226.74 158.18 226.49C158.6 226.25 158.95 225.9 159.19 225.47C159.44 225.05 159.56 224.57 159.56 224.08C159.55 223.59 159.42 223.11 159.17 222.69C151.4 209.56 138.68 200.03 124.01 196.27L124.01 180.77C137.72 177.2 148.79 167.03 153.61 153.87C155.85 154.89 158.29 155.42 160.81 155.42C170.44 155.42 178.28 147.58 178.28 137.95C178.28 130.17 173.17 123.57 166.14 121.31ZM58.72 149.88C52.14 149.88 46.78 144.53 46.78 137.95C46.78 131.37 52.14 126.01 58.72 126.01C60.3 126.01 61.86 126.33 63.31 126.93L63.31 133.18C62.19 132.73 60.96 132.42 59.61 132.29C56.85 132.01 54.59 132.54 54.34 132.6C52.86 132.96 51.95 134.45 52.31 135.93C52.67 137.42 54.16 138.33 55.64 137.98C55.66 137.98 57.31 137.6 59.19 137.81C61.08 138.03 62.44 138.73 63.32 139.94C63.38 142.81 63.72 145.67 64.34 148.47C62.62 149.39 60.71 149.88 58.72 149.88ZM89.84 204L103.94 221.33L67.87 221.33C73.49 213.64 81.12 207.64 89.84 204ZM151.65 221.33L115.59 221.33L129.69 204C138.4 207.64 146.03 213.64 151.65 221.33ZM120.66 201.18C121.83 201.43 122.99 201.72 124.13 202.05L109.76 219.71L95.39 202.05C96.54 201.72 97.69 201.43 98.86 201.18C99.48 201.04 100.03 200.7 100.43 200.21C100.83 199.72 101.05 199.1 101.05 198.47L101.05 181.82C102.78 182.04 104.55 182.15 106.33 182.15L113.19 182.15C114.98 182.15 116.74 182.04 118.47 181.82L118.47 198.47C118.47 199.1 118.69 199.72 119.09 200.21C119.49 200.7 120.05 201.04 120.66 201.18ZM160.81 149.88C158.85 149.88 156.91 149.4 155.19 148.47C155.81 145.67 156.15 142.81 156.2 139.94C157.09 138.73 158.45 138.03 160.33 137.81C162.2 137.6 163.83 137.97 163.88 137.98C164.59 138.14 165.34 138.02 165.96 137.64C166.58 137.25 167.02 136.64 167.19 135.94C167.37 135.23 167.25 134.48 166.88 133.85C166.5 133.23 165.9 132.78 165.19 132.6C164.94 132.54 162.68 132.01 159.91 132.29C158.57 132.42 157.33 132.73 156.21 133.18L156.21 126.93C157.67 126.32 159.23 126.01 160.81 126.01C167.39 126.01 172.74 131.37 172.74 137.95C172.74 144.53 167.39 149.88 160.81 149.88Z" fill="#000000" fill-opacity="1.000000" fill-rule="nonzero"/>
                        <path id="Vector" d="M89.02 123.19C86.33 123.19 84.15 126.18 84.15 129.86C84.15 133.54 86.33 136.53 89.02 136.53C91.7 136.53 93.89 133.54 93.89 129.86C93.89 126.18 91.7 123.19 89.02 123.19ZM130.51 123.19C127.82 123.19 125.64 126.18 125.64 129.86C125.64 133.54 127.82 136.53 130.51 136.53C133.2 136.53 135.38 133.54 135.38 129.86C135.38 126.18 133.2 123.19 130.51 123.19ZM97.24 117.47C97.76 116.95 98.05 116.25 98.05 115.51C98.05 114.78 97.76 114.07 97.24 113.55C92.86 109.18 85.75 109.18 81.37 113.55C80.86 114.07 80.57 114.78 80.57 115.51C80.57 116.24 80.86 116.94 81.38 117.46C81.9 117.98 82.6 118.27 83.33 118.27C84.07 118.27 84.77 117.99 85.29 117.47C87.5 115.26 91.11 115.26 93.32 117.47C93.86 118.01 94.57 118.28 95.28 118.28C95.99 118.28 96.7 118.01 97.24 117.47ZM138.57 109.73C138.83 109.47 139.03 109.17 139.17 108.83C139.31 108.5 139.39 108.14 139.39 107.77C139.39 107.41 139.31 107.05 139.17 106.71C139.03 106.38 138.83 106.07 138.57 105.81C136.46 103.7 133.64 102.53 130.64 102.53C127.65 102.53 124.83 103.7 122.71 105.81C122.19 106.34 121.91 107.04 121.91 107.77C121.91 108.5 122.2 109.21 122.72 109.72C123.24 110.24 123.94 110.53 124.67 110.53C125.4 110.54 126.11 110.25 126.63 109.73C127.15 109.2 127.78 108.78 128.47 108.5C129.16 108.21 129.9 108.07 130.64 108.07C132.16 108.07 133.58 108.66 134.66 109.73C134.91 109.99 135.22 110.19 135.56 110.33C135.89 110.47 136.25 110.54 136.62 110.54C136.98 110.54 137.34 110.47 137.68 110.33C138.01 110.19 138.32 109.99 138.57 109.73ZM109.76 149.39C114.9 149.39 119.51 145.95 120.97 141.03C121.08 140.69 121.11 140.32 121.07 139.96C121.04 139.6 120.93 139.25 120.75 138.93C120.58 138.61 120.35 138.32 120.06 138.1C119.78 137.87 119.46 137.7 119.11 137.59C118.76 137.49 118.39 137.45 118.03 137.49C117.67 137.53 117.32 137.64 117 137.81C116.68 137.99 116.4 138.22 116.17 138.5C115.94 138.78 115.77 139.11 115.66 139.46C114.9 142.04 112.47 143.85 109.76 143.85C107.06 143.85 104.63 142.04 103.86 139.46C103.76 139.11 103.59 138.78 103.36 138.5C103.13 138.22 102.85 137.98 102.53 137.81C102.21 137.64 101.85 137.53 101.49 137.49C101.13 137.45 100.77 137.49 100.42 137.59C100.07 137.7 99.74 137.87 99.46 138.1C99.18 138.33 98.94 138.61 98.77 138.93C98.6 139.25 98.49 139.6 98.45 139.96C98.41 140.32 98.45 140.69 98.55 141.04C100.02 145.95 104.63 149.39 109.76 149.39Z" fill="#000000" fill-opacity="1.000000" fill-rule="nonzero"/>
                    </g>
                </svg>
            </div>
        <div class="mt-14 flex flex-col items-center">
            <Header>Log into the App</Header>
            <LoginForm/>
        </div>
    </div>
{:else}
    <div>
        Not loaded yet...
    </div>
{/if}
